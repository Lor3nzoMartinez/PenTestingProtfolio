import socket

#   Variables

e = 'Operation timed out'
s = socket.socket()

#   Functions
def retBanner(ip, port):
    try:
        socket.setdefaulttimeout(2)
        s = socket.socket()
        s.connect((ip, int(port)))
        banner = s.recv(1024)
        return banner
    except:
        return

def checkVulns(banner):
    if 'FreeFloat Ftp Server (Version 1.00)' in banner:
        print ('[+] FreeFloat FTP server is vulnerable.')
    elif '3Com 3CDaemon FTP Server Version 2.0' in banner:
        print('[+] 3Com Daemon FTP Server is vulnerable.')
    elif 'Ability Server 2.34' in banner:
        print('[+] Ability FTP Server is vulnerable.')
    elif 'Sami FTP Server 2.0.2' in banner:
        print('[+] Sami FTP Server 2.0.2 is Vulnerable.')
    else:
        print('[-] FTP Server is not vulnerable.')
    return

def main():
    portlist = [21,22,25,80,110,443]
    for x in range(1,255):
        ip = '192.168.50.'+str(x)
        for port in portlist:
            banner = retBanner(ip, port)
            if banner:
                print('[+] ' + ip + ': ' + banner)
                checkVulns(banner)


#   Prompts
'''
ip = input("Enter IP for probing: ")
port = input("Enter Port to be scanned: ")
Time = input("How long is timeout in seconds: ")
'''
#   Execution

main()


